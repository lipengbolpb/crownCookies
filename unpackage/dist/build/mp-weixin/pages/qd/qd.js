(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/qd/qd"],{"281e":function(n,e,t){"use strict";var o=t("4424"),r=t.n(o);r.a},4424:function(n,e,t){},"7ef9":function(n,e,t){"use strict";var o,r=function(){var n=this,e=n.$createElement;n._self._c},a=[];t.d(e,"b",(function(){return r})),t.d(e,"c",(function(){return a})),t.d(e,"a",(function(){return o}))},"88a3":function(n,e,t){"use strict";(function(n){t("d916");o(t("66fd"));var e=o(t("b29b"));function o(n){return n&&n.__esModule?n:{default:n}}n(e.default)}).call(this,t("543d")["createPage"])},b29b:function(n,e,t){"use strict";t.r(e);var o=t("7ef9"),r=t("d6d0");for(var a in r)"default"!==a&&function(n){t.d(e,n,(function(){return r[n]}))}(a);t("281e");var u,i=t("f0c5"),s=Object(i["a"])(r["default"],o["b"],o["c"],!1,null,"a3aa13a4",null,!1,o["a"],u);e["default"]=s.exports},d6d0:function(n,e,t){"use strict";t.r(e);var o=t("f8aa"),r=t.n(o);for(var a in o)"default"!==a&&function(n){t.d(e,n,(function(){return o[n]}))}(a);e["default"]=r.a},f8aa:function(n,e,t){"use strict";(function(n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(t("4795")),r=t("51c7");function a(n){return n&&n.__esModule?n:{default:n}}function u(n,e,t,o,r,a,u){try{var i=n[a](u),s=i.value}catch(c){return void t(c)}i.done?e(s):Promise.resolve(s).then(o,r)}function i(n){return function(){var e=this,t=arguments;return new Promise((function(o,r){var a=n.apply(e,t);function i(n){u(a,o,r,i,s,"next",n)}function s(n){u(a,o,r,i,s,"throw",n)}i(void 0)}))}}var s={name:"qdGetPrize",data:function(){return{imgUrl:r.config.staticUrl,ipx:!1,latitude:"",longitude:"",speed:"",accuracy:"",openid:"",getqp:!1,gethb:!1,overOne:!1,getNull:!1,userScanMonthCount:"",needScan:"",hasNum:"",animationData:{},runDegs:"",awardsList:["谢谢参与","青啤有一套","随机微信红包","谢谢参与","青啤有一套","随机微信红包"],earnMoney:"",surplusMoney:""}},onUnload:function(){this.animationData={}},onLoad:function(n){return i(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:case"end":return n.stop()}}),n)})))()},onShow:function(){var n=this;n.getUserLocation();var e=wx.createAnimation({duration:4e3,timingFunction:"ease"});this.animation=e,console.log(this.animation)},onShareAppMessage:function(n){return"button"===n.from&&console.log(n.target),{title:"青岛啤酒",path:"/pages/home/home",imageUrl:this.imgUrl+"share.png"}},mounted:function(){this.initData()},methods:{initData:function(){var e=this;return i(o.default.mark((function t(){var a,u;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={openid:e.$store.state.openid,projectServerName:"liaoning"},t.next=3,(0,r.post)("/turnaroundDraw/queryTurnaroundDrawUser",a);case 3:u=t.sent,console.log(u),0==u.result.code?0==u.result.businessCode?(e.userScanMonthCount=String(u.reply.userScanMonthCount),e.needScan=String(u.reply.turnaroundScan),e.hasNum=String(u.reply.turnaroundSurplusCount)):(e.userScanMonthCount="0",e.needScan="0",e.hasNum="0"):n.showModal({title:"尊敬的用户",content:u.result.msg});case 6:case"end":return t.stop()}}),t)})))()},cj:function(){this.hasNum>0?this.getLottery():n.showModal({title:"尊敬的用户",content:"您当前抽奖次数为0"})},bigPrize:function(){n.navigateTo({url:"../mine/prizeList"})},toMine:function(){n.switchTab({url:"../mine/mine"})},oneMore:function(){this.gethb=!1},getLottery:function(){var e=this;return i(o.default.mark((function t(){var a,u,i,s;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.getqp=!1,e.gethb=!1,e.overOne=!1,e.getNull=!1,n.showLoading({title:"抽奖中..."}),a={openid:e.$store.state.openid,projectServerName:"liaoning",longitude:e.longitude,latitude:e.latitude},t.next=8,(0,r.post)("/turnaroundDraw/exchangetTurnaroundDraw",a);case 8:u=t.sent,console.log(u),n.hideLoading(),0==u.result.code?(i=6,0==u.result.businessCode?(e.hasNum=String(u.reply.surplusCount),e.userScanMonthCount=String(u.reply.userScanMonthCount),e.needScan=String(u.reply.turnaroundScan),"P"==u.reply.prizeType||"p"==u.reply.prizeType?(s=2,e.runDegs=e.runDegs||0,e.runDegs=e.runDegs+(360-e.runDegs%360)+(360*i-s*(360/e.awardsList.length)),e.animation.rotate(e.runDegs).step(),e.animationData=e.animation.export(),setTimeout((function(){console.log("抽中了奖品: "+s),e.getqp=!0}),4300)):"0"==u.reply.prizeType&&u.reply.earnMoney>0?(s=3,e.runDegs=e.runDegs||0,e.runDegs=e.runDegs+(360-e.runDegs%360)+(360*i-s*(360/e.awardsList.length)),e.animation.rotate(e.runDegs).step(),e.animationData=e.animation.export(),setTimeout((function(){console.log("抽中了奖品: "+s),e.earnMoney=u.reply.earnMoney,e.surplusMoney=u.reply.surplusMoney,e.gethb=!0,u.reply.earnMoney>=1?e.overOne=!0:e.overOne=!1}),4300)):(s=1,e.runDegs=e.runDegs||0,e.runDegs=e.runDegs+(360-e.runDegs%360)+(360*i-s*(360/e.awardsList.length)),e.animation.rotate(e.runDegs).step(),e.animationData=e.animation.export(),setTimeout((function(){console.log("抽中了奖品: "+s),e.getNull=!0}),4300))):8==u.result.businessCode?(e.hasNum=String(u.reply.surplusCount),e.userScanMonthCount=String(u.reply.userScanMonthCount),e.needScan=String(u.reply.turnaroundScan),s=1,e.runDegs=e.runDegs||0,e.runDegs=e.runDegs+(360-e.runDegs%360)+(360*i-s*(360/e.awardsList.length)),e.animation.rotate(e.runDegs).step(),e.animationData=e.animation.export(),setTimeout((function(){console.log("抽中了奖品: "+s),e.getNull=!0}),4300)):n.showModal({title:"尊敬的用户",content:u.result.msg})):n.showModal({title:"尊敬的用户",content:u.result.msg});case 12:case"end":return t.stop()}}),t)})))()},closeGetQp:function(){this.getqp=!1},closeGetNull:function(){this.getNull=!1},getUserLocation:function(){var n=this;wx.getSetting({success:function(e){void 0!=e.authSetting["scope.userLocation"]&&1!=e.authSetting["scope.userLocation"]?wx.showModal({title:"请求授权当前位置",content:"是否授权您的地理位置",success:function(e){e.cancel||e.confirm&&wx.openSetting({success:function(e){1==e.authSetting["scope.userLocation"]?(wx.showToast({title:"授权成功",icon:"success",duration:1e3}),n.geo()):wx.showToast({title:"授权失败",icon:"none",duration:1e3})}})}}):void 0==e.authSetting["scope.userLocation"]?n.geo():(console.log("授权成功"),n.geo())}})},geo:function(){var n=this;wx.getLocation({type:"wgs84",success:function(e){n.latitude=e.latitude,n.longitude=e.longitude,n.speed=e.speed,n.accuracy=e.accuracy},fail:function(){}})}}};e.default=s}).call(this,t("543d")["default"])}},[["88a3","common/runtime","common/vendor"]]]);