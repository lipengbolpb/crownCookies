(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mine/mine"],{"1b60":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(n("4795")),a=n("51c7");function s(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,o,a,s,i){try{var r=e[s](i),u=r.value}catch(c){return void n(c)}r.done?t(u):Promise.resolve(u).then(o,a)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var s=e.apply(t,n);function r(e){i(s,o,a,r,u,"next",e)}function u(e){i(s,o,a,r,u,"throw",e)}r(void 0)}))}}var u={data:function(){return{imgUrl:a.config.staticUrl,sharePath:"pages/mine/mine?provinceCode=LN",shareImg:"",statusBarH:this.StatusBar,customBarH:this.CustomBar,userInfo:{avatarUrl:"",nickName:""},telBox:!1,tel:"024-31932190",allAccountMoney:"0",total:"0",userScanMonthCount:"0",totalMoney:"0",needTx:!1,hasPhone:!1,mobileToast:!1,telNum:"",successToast:!1,failToast:!1}},onLoad:function(t){var n=this;e.getStorage({key:"userInfo",success:function(e){console.log(e.data),n.userInfo=e.data}})},onShow:function(){this.$store.dispatch("xcxOpenidGet"),this.needTx&&(console.log("aaa"),this.giveSpackTx());var t=e.getStorageSync("tel");console.log(t),t?(this.hasPhone=!0,this.telNum=t):(this.hasPhone=!1,this.telNum="");var n=this;e.getStorage({key:"userInfo",success:function(e){console.log(e.data);e.data;n.userInfo.avatarUrl=e.data.avatarUrl},fail:function(e){}}),e.getStorage({key:"userMsg",success:function(t){n.openid=t.data.openid,console.log(n.openid),n.$store.commit("getOpenid",t.data.openid),n.openid?n.initData():e.navigateTo({url:"../getOpenid/getOpenid?provinceCode=LN&type=openid"})},fail:function(){n.openid||e.navigateTo({url:"../getOpenid/getOpenid?provinceCode=LN&type=openid"}),console.log(n.openid)}})},methods:{initData:function(){var t=this;return r(o.default.mark((function n(){var s,i;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return s={openid:t.$store.state.openid,hbopenid:"",projectServerName:"liaoning"},n.next=3,(0,a.post)("/turnaroundDraw/queryUserHomePage",s);case 3:i=n.sent,console.log("用户数据"+i),0==i.result.code?0==i.result.businessCode?(t.allAccountMoney=i.reply.allAccountMoney,t.total=i.reply.total,t.totalMoney=i.reply.totalMoney,t.userScanMonthCount=i.reply.userScanMonthCount):(t.allAccountMoney="0",t.total="0",t.totalMoney="0",t.userScanMonthCount="0"):e.showModal({title:"提示",content:i.result.msg});case 6:case"end":return n.stop()}}),n)})))()},toFanbei:function(){e.navigateTo({url:"./cardFanbei"})},toMiandan:function(){e.navigateTo({url:"./cardMiandan"})},toYouhui:function(){e.navigateTo({url:"./cardYouhui"})},getUserInfoFn:function(){var t=this;e.getUserInfo({success:function(n){console.log(n.userInfo),t.userInfo.avatarUrl=n.userInfo.avatarUrl,t.userInfo.nickName=n.userInfo.nickName,e.setStorage({key:"userInfo",data:n.userInfo})}})},toBag:function(){e.navigateTo({url:"../mine/hbList"})},toPrize:function(){e.navigateTo({url:"../mine/prizeList"})},toKefu:function(){},toStrcode:function(){e.navigateTo({url:"../mine/strCode"})},toRule:function(){e.navigateTo({url:"../rule/rule?sku=unYear"})},toTel:function(){this.telBox=!0},telClose:function(){this.telBox=!1},callTel:function(){wx.makePhoneCall({phoneNumber:this.tel})},userPhone:function(e){console.log(e.detail.errMsg),-1!=e.detail.errMsg.lastIndexOf("ok")?(this.mobileToast=!1,this.$store.state.session_key?this.parsePhone(e):(this.$store.dispatch("xcxOpenidGet"),this.parsePhone(e)),console.log(this.$store.state.session_key)):this.mobileToast=!0},parsePhone:function(t){var n=this,o={sessionKey:this.$store.state.session_key,encryptedData:t.detail.encryptedData,iv:t.detail.iv,provinceCode:"lnqp"};return new Promise((function(t,a){e.request({url:"https://xcxact.vjifen.com/api/decrypt",method:"POST",data:o,success:function(t){console.log(t.data.data.decryptData.phoneNumber);var o=t.data.data.decryptData.phoneNumber;if(n.$store.commit("userPhone",o),n.savePhone(),e.setStorageSync("tel",o),n.hasPhone=void 0==o?1:o,console.log(n.hasPhone),n.hasPhone)if(n.totalMoney>=1){if(!n.$store.state.hbopenid)return n.needTx=!0,void e.navigateTo({url:"../getOpenid/getOpenid?provinceCode=LN&type=hbopenid"});n.needTx=!0,n.giveSpackTx()}else n.failToast=!0},fail:function(t){n.hasPhone=!0,e.showModal({title:"提示",content:"解析手机号结果"+res.data}),a("decrypt",t),console.log(res.data)}})}))},savePhone:function(){var e=this;return r(o.default.mark((function t(){var n;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={openid:e.$store.state.openid,projectServerName:"liaoning",phonenum:e.$store.state.phoneNumber?e.$store.state.phoneNumber:"",isCaptcha:0},t.next=3,(0,a.post)("/user/updateUserInfoMobile",n);case 3:t.sent,console.log("savePhoneNumber");case 5:case"end":return t.stop()}}),t)})))()},closeMobile:function(){this.mobileToast=!1},giveSpackTx:function(){var t=this;return r(o.default.mark((function n(){var s,i;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(t.totalMoney>=1)){n.next=19;break}if(t.$store.state.hbopenid){n.next=6;break}return console.log(t.$store.state.hbopenid),t.needTx=!0,e.navigateTo({url:"../getOpenid/getOpenid?provinceCode=LN&type=hbopenid"}),n.abrupt("return");case 6:return console.log(t.$store.state.hbopenid),console.log(t.needTx),e.showLoading({title:"提现中"}),s={openid:t.$store.state.openid,hbopenid:t.$store.state.hbopenid,projectServerName:"liaoning"},n.next=12,(0,a.post)("/gifts/getGiftspack",s);case 12:i=n.sent,console.log(i),e.hideLoading(),t.needTx=!1,"0"==i.result.code?"0"==i.result.businessCode?(t.successToast=!0,t.totalMoney=0):"1"==i.result.businessCode?e.showModal({title:"尊敬的用户",content:"您的红包金额不足，再喝几瓶攒够1元发红包！"}):"2"==i.result.businessCode?e.showModal({title:"提示",content:"呜呜，系统开了个小差，请稍后重试！"}):"4"==i.result.businessCode?e.showModal({title:"提示",content:"提现处理中，请稍后查看详细记录"}):"3"==i.result.businessCode?e.showModal({title:"尊敬的用户",content:"根据国家法规对支付服务实名制的要求，请到微信中进行实名认证。实名认证方法：进入【微信】->【我】->【钱包】->【···】->【支付管理】，即可实名认证。"}):"-1"==i.result.businessCode?e.showModal({title:"提示",content:"系统升级中..."}):"-2"==i.result.businessCode?e.showModal({title:"提示",content:"提现操作过于频繁"}):"5"==i.result.businessCode?e.showModal({title:"提示",content:i.result.msg}):e.showModal({title:"提示",content:"呜呜，系统开了个小差，请稍后重试！"}):"-1"==i.result.code?e.showModal({title:"尊敬的用户",content:"系统升级中..."}):e.showModal({title:"尊敬的用户",content:"呜呜，服务开了个小差，请稍后重试！"}),n.next=20;break;case 19:t.failToast=!0;case 20:case"end":return n.stop()}}),n)})))()},iknow:function(){this.successToast=!1,this.initData()},failIknow:function(){this.failToast=!1}}};t.default=u}).call(this,n("543d")["default"])},"30b9":function(e,t,n){"use strict";var o=n("f9d5"),a=n.n(o);a.a},"402b":function(e,t,n){"use strict";var o,a=function(){var e=this,t=e.$createElement;e._self._c},s=[];n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}))},"75c9":function(e,t,n){"use strict";(function(e){n("d916");o(n("66fd"));var t=o(n("c05a"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},c05a:function(e,t,n){"use strict";n.r(t);var o=n("402b"),a=n("fd86");for(var s in a)"default"!==s&&function(e){n.d(t,e,(function(){return a[e]}))}(s);n("30b9");var i,r=n("f0c5"),u=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"77836297",null,!1,o["a"],i);t["default"]=u.exports},f9d5:function(e,t,n){},fd86:function(e,t,n){"use strict";n.r(t);var o=n("1b60"),a=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=a.a}},[["75c9","common/runtime","common/vendor"]]]);